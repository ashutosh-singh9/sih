<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TimeTable Genius - Approvals</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background:linear-gradient(180deg, #d6a7ff 0%,#9088ff 30% ,#000000 100%);}
        .sidebar {
            background: linear-gradient(180deg, #5d00ae 0%,#0f0067 50% ,#000000 100%);
        }
        #ai-modal-overlay.hidden {
            display: none;
        }
    </style>
</head>
<body class="flex h-screen">

    <!-- Sidebar -->
   <aside class="w-64 sidebar text-white flex flex-col flex-shrink-0">
         <div class="p-6 text-center border-b border-white/20">
            <h1 class="text-2xl font-bold">TimeTable Genius</h1>
        </div>
        <nav class="flex-1 px-4 py-6 space-y-2">
            <a href="dashboard.html" class="flex items-center px-4 py-2.5 text-white/80 hover:bg-white/10 rounded-lg">
                <i class="fas fa-tachometer-alt w-6 h-6 mr-3"></i> Dashboard
            </a>
            <a href="data-input.html" class="flex items-center px-4 py-2.5 text-white/80 hover:bg-white/10 rounded-lg">
                <i class="fas fa-database w-6 h-6 mr-3"></i> Data Input
            </a>
            <a href="view-timetables.html" class="flex items-center px-4 py-2.5 text-white/80 hover:bg-white/10 rounded-lg">
                <i class="fas fa-calendar-alt w-6 h-6 mr-3"></i> View Timetables
            </a>
            <a href="approvals.html" class="flex items-center px-4 py-2.5 text-white bg-white/20 rounded-lg font-semibold">
                <i class="fas fa-check-circle w-6 h-6 mr-3"></i> Approvals
            </a>
            <a href="suggestions.html" class="flex items-center px-4 py-2.5 text-white/80 hover:bg-white/10 rounded-lg">
                <i class="fas fa-lightbulb w-6 h-6 mr-3"></i> Suggestions
            </a>
            <a href="departments-shifts.html" class="flex items-center px-4 py-2.5 text-white/80 hover:bg-white/10 rounded-lg">
                <i class="fas fa-building w-6 h-6 mr-3"></i> Departments
            </a>
            <a href="departments-shifts.html" class="flex items-center px-4 py-2.5 text-white/80 hover:bg-white/10 rounded-lg">
                <i class="fas fa-clock w-6 h-6 mr-3"></i> Shifts
            </a>
             <a href="settings.html" class="flex items-center px-4 py-2.5 text-white/80 hover:bg-white/10 rounded-lg">
                <i class="fas fa-cog w-6 h-6 mr-3"></i> Settings
            </a>
        </nav>
        <div class="p-4 border-t border-white/20">
            <a href="login.html" class="flex items-center px-4 py-2.5 text-white/80 hover:bg-white/10 rounded-lg">
                <i class="fas fa-sign-out-alt w-6 h-6 mr-3"></i> Logout
            </a>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 p-8  overflow-y-auto">
        <header class="mb-8 bg">
            <h2 class="text-3xl font-bold text-black-800">Approval Workflow</h2>
            <p class="text-black-500">Manage timetables submitted for review and approval.</p>
        </header>

        <div class="bg-white p-6 rounded-xl shadow-md">
            <h3 class="text-xl font-semibold text-gray-800 mb-4">Pending Requests</h3>
            
            <!-- Approval Request List -->
            <div class="space-y-4">
                <!-- Card 1 -->
                <div class="border rounded-lg p-4 flex items-center justify-between hover:shadow-lg transition-shadow" data-timetable-id="cse5">
                    <div>
                        <p class="font-semibold text-lg text-gray-800">Timetable for Computer Science - 5th Sem</p>
                        <p class="text-sm text-gray-500">Submitted by: Admin User | On: 12 Sep 2025</p>
                    </div>
                    <div class="flex items-center space-x-3">
                        <span class="text-sm font-medium bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full">Pending</span>
                        <button class="text-gray-500 hover:text-purple-600 text-lg" title="View Timetable"><i class="fas fa-eye"></i></button>
                        <button class="ai-review-btn bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold flex items-center space-x-2"><span class="text-lg">✨</span><span>AI Review</span></button>
                        <button class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-semibold">Approve</button>
                        <button class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg font-semibold">Reject</button>
                    </div>
                </div>

                <!-- Card 2 -->
                 <div class="border rounded-lg p-4 flex items-center justify-between hover:shadow-lg transition-shadow" data-timetable-id="ece3">
                    <div>
                        <p class="font-semibold text-lg text-gray-800">Timetable for Electronics - 3rd Sem</p>
                        <p class="text-sm text-gray-500">Submitted by: Admin User | On: 11 Sep 2025</p>
                    </div>
                    <div class="flex items-center space-x-3">
                         <span class="text-sm font-medium bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full">Pending</span>
                        <button class="text-gray-500 hover:text-purple-600 text-lg" title="View Timetable"><i class="fas fa-eye"></i></button>
                        <button class="ai-review-btn bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold flex items-center space-x-2"><span class="text-lg">✨</span><span>AI Review</span></button>
                        <button class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-semibold">Approve</button>
                        <button class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg font-semibold">Reject</button>
                    </div>
                </div>
            </div>

             <h3 class="text-xl font-semibold text-gray-800 mt-10 mb-4">Approval History</h3>
             <!-- History List -->
             <div class="space-y-4">
                  <!-- Card 3 -->
                <div class="border rounded-lg p-4 flex items-center justify-between bg-gray-50">
                    <div>
                        <p class="font-semibold text-lg text-gray-800">Timetable for Mechanical - 7th Sem</p>
                        <p class="text-sm text-gray-500">Submitted by: Admin User | On: 10 Sep 2025</p>
                    </div>
                    <div class="flex items-center space-x-3">
                        <span class="text-sm font-medium bg-green-100 text-green-800 px-3 py-1 rounded-full">Approved by HOD</span>
                        <button class="text-gray-400 text-lg" disabled><i class="fas fa-eye"></i></button>
                    </div>
                </div>

                <!-- Card 4 -->
                <div class="border rounded-lg p-4 flex items-center justify-between bg-gray-50">
                    <div>
                        <p class="font-semibold text-lg text-gray-800">Timetable for Computer Science - 3rd Sem</p>
                        <p class="text-sm text-gray-500">Submitted by: Admin User | On: 09 Sep 2025</p>
                    </div>
                    <div class="flex items-center space-x-3">
                         <span class="text-sm font-medium bg-red-100 text-red-800 px-3 py-1 rounded-full">Rejected</span>
                        <button class="text-gray-400 text-lg" disabled><i class="fas fa-eye"></i></button>
                    </div>
                </div>
             </div>
        </div>
    </main>

    <!-- AI Review Modal -->
    <div id="ai-modal-overlay" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden">
        <div id="ai-modal" class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl transform transition-all opacity-0 -translate-y-10">
            <div class="p-6 border-b flex justify-between items-center">
                <h3 id="ai-modal-title" class="text-2xl font-bold text-gray-800 flex items-center"><span class="text-3xl mr-3">✨</span> AI Timetable Review</h3>
            </div>
            <div class="p-6">
                <div id="ai-modal-loading" class="text-center">
                    <i class="fas fa-spinner fa-spin text-purple-500 text-3xl"></i>
                    <p class="mt-3 text-gray-600">Gemini is analyzing the schedule...</p>
                </div>
                <div id="ai-modal-content" class="hidden space-y-4 text-gray-700"></div>
            </div>
            <div class="p-4 bg-gray-50 rounded-b-2xl text-right">
                <button id="close-modal-btn" class="bg-gray-200 text-gray-800 px-5 py-2 rounded-lg font-semibold hover:bg-gray-300">Close</button>
            </div>
        </div>
    </div>

    <script>
        const reviewButtons = document.querySelectorAll('.ai-review-btn');
        const modalOverlay = document.getElementById('ai-modal-overlay');
        const modal = document.getElementById('ai-modal');
        const modalTitle = document.getElementById('ai-modal-title');
        const modalLoading = document.getElementById('ai-modal-loading');
        const modalContent = document.getElementById('ai-modal-content');
        const closeModalBtn = document.getElementById('close-modal-btn');

        const aiResponses = {
            cse5: `
                <div>
                    <h4 class="font-semibold text-lg text-green-700">Pros:</h4>
                    <ul class="list-disc list-inside mt-1">
                        <li><strong>Balanced Faculty Load:</strong> Senior faculty workload is evenly distributed throughout the week.</li>
                        <li><strong>Lab Slot Optimization:</strong> Practical lab sessions are scheduled in the afternoon, maximizing student concentration in morning theory classes.</li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold text-lg text-red-700 mt-3">Cons:</h4>
                    <ul class="list-disc list-inside mt-1">
                        <li><strong>Student Gap:</strong> There is a 3-hour gap for students on Thursday, which may lead to disengagement.</li>
                    </ul>
                </div>
                <div class="mt-4 p-3 bg-blue-50 border-l-4 border-blue-400">
                    <p class="font-bold text-blue-800">Recommendation:</p>
                    <p class="text-blue-700">This is a strong schedule. Consider adding a skill-development workshop in the Thursday gap. <strong>Approval is recommended.</strong></p>
                </div>`,
            ece3: `
                 <div>
                    <h4 class="font-semibold text-lg text-green-700">Pros:</h4>
                    <ul class="list-disc list-inside mt-1">
                        <li><strong>No Student Gaps:</strong> Classes are scheduled consecutively, which is efficient for students.</li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold text-lg text-red-700 mt-3">Cons:</h4>
                    <ul class="list-disc list-inside mt-1">
                        <li><strong>Faculty Overload:</strong> Dr. Priya Singh has 4 back-to-back classes on Monday, which is a high cognitive load.</li>
                        <li><strong>Resource Conflict:</strong> The primary electronics lab is booked for 5 hours straight on Wednesday, leaving no time for maintenance or other batch work.</li>
                    </ul>
                </div>
                <div class="mt-4 p-3 bg-red-50 border-l-4 border-red-400">
                    <p class="font-bold text-red-800">Recommendation:</p>
                    <p class="text-red-700">The faculty overload and resource bottleneck are significant issues. <strong>Rejection is recommended, with a note to redistribute Monday's classes.</strong></p>
                </div>`
        };

        const openModal = (timetableId) => {
            modalOverlay.classList.remove('hidden');
            setTimeout(() => {
                modal.classList.add('opacity-100', 'translate-y-0');
                modal.classList.remove('opacity-0', '-translate-y-10');
            }, 10);
            
            modalLoading.classList.remove('hidden');
            modalContent.classList.add('hidden');

            // Mock Gemini API Call
            setTimeout(() => {
                modalContent.innerHTML = aiResponses[timetableId] || "<p>No analysis available for this timetable.</p>";
                modalLoading.classList.add('hidden');
                modalContent.classList.remove('hidden');
            }, 2000);
        };

        const closeModal = () => {
            modal.classList.remove('opacity-100', 'translate-y-0');
            modal.classList.add('opacity-0', '-translate-y-10');
            setTimeout(() => {
                modalOverlay.classList.add('hidden');
            }, 300);
        };

        reviewButtons.forEach(button => {
            button.addEventListener('click', (event) => {
                const timetableId = event.currentTarget.closest('[data-timetable-id]').dataset.timetableId;
                openModal(timetableId);
            });
        });

        closeModalBtn.addEventListener('click', closeModal);
        modalOverlay.addEventListener('click', (e) => {
            if (e.target === modalOverlay) {
                closeModal();
            }
        });

    </script>
</body>
</html>

